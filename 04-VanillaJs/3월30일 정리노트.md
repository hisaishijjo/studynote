# 데이터 읽기,쓰기

<br>

## 1. 쿠키

* 사용자의 웹 브라우저에 저장되는 텍스트 데이터
* 모든 사용자가 각각 자신만의 정보를 저장할 수 있기 때문에 개인화 기능을 구현하는데 활용될 수 있다.
* 정보를 저장하는데 있어 "이름=값; 유효시간; 유효경로; 유효도메인" 으로 설정한다.
* 이름과 값은 모두 URLEncoding 처리 되어야 한다(영어,숫자는 제외)
* 유효시간은 초단위로 기록.
  * 설정되지 않으면 브라우저를 닫기 전가지 데이터가 유지도된다
  * 0으로 설정하면 즉시삭제된다
  * 0보다 큰 숫자로 설정하면 해당 초가 지나기 전까지는 브라우저를 재시작 하더라도 저장된 정보가 유지된다.
* 유효경로는 해당 쿠키값을 읽고 쓸 수 있는 특정 폴더 경로를 지정할 수있다
  * (일반적으로는 "/"만 지정하여 사이트 전역에서 쿠키가 유효하게 설장한다.)
* 쿠기는 기본적으로 저장된 도메인에서만 유효하다.
  * www.naver.com에서 저장한 쿠키는 blog.naver.com에서는 식별되지 않음
  * "naver.com"으로 유효도메인을  설정하면 앞에 붙는 호스트이름에 상관없이 쿠키가 공유된다
  * 패밀리 사이트 간의 정보공유를 위해 많이 사용된다(통합로그인)

<br>

### 1-1. 장점

*대부분의 브라우저가 지원

<br>

### 1-2. 단점

* 매 http요청마다 포함되어 api호출로 서버에 부담(페이지 이동시마다 백엔드에 무조건 모든 쿠키가 전송됨)
* 쿠키의 용량이 적음(약 4kb)
* 암호화 존재가 없어 사용자 정보 도난위험

<br>

### 1-3. 사용 예

* 오늘 본 상품
* 오늘 하루 이 창 열지 않음.

<br>

## 2. 웹 스토리지

* 쿠기의 단점을 보완해 html5에서 추가된 기술로 로컬스토리지와 세션스토리지로 구분

<br>

### 2-1. 특징

* 웹스토리지는 key와 value 형태로 이루어짐
* 웹스토리지는 클라이언트에 대한 정보를 저장.
* 웹스토리지는 로컬에만 정보를 저장,쿠기는 서버와 로컬에 정보를저장.

<br>

### 2-2. 종류

|종류|특징|
|---|---|
|`로컬스토리지`|클라이언트에 대한 정보를 영구적으로 저장|
|`세션스토리지`|세선 종료(브라우저를 닫을시) 클라이언트에 대한 정보 삭제|
|||

<br>

### 2-3. 장점

* 서버에 불필요하게 데이터를 저장하지 않는다(백엔드로 전송되지 않음)
* 저장 가능한 데이터의 용량이 크다 (약 6mb)

<br>

### 2-4. 단점

* html5를 지원하지 않는 브라우저의 경우 사용 불가.(현재는 거의 없음)

<br>

### 2-5.사용예

* 로컬스토리지 : 자동 로그인 저장
* 세션스토리지 : 입력 폼 정보 저장,비로그인 장바구니
  
<br>

# 기타기능

<br>

## 1. window 객체

|이름|설명|
|---|---|
|`window.open()`|새창 (혹은 탭) 띄우는 윈도우 내장 기능|
||파라미터안에 ('오픈할주소','팝업창의이름','크기지정,스크롤지정,툴바지정,메뉴바지정,주소창)등을 지정할수있다|
||두번째 파라미터인 팝업창의 이름을 비워두면 새로운창을 여는 반면 같은이름의 팝업창을 값으로 준다면 한번 열렸던 창에서 주소를 갱신하며 열린다.|
|||

<br>

## 2. navigator

|기능|설명|
|---|---|
|`navigator.appName`|브라우저 이름|
|`navigator.appCodeName`|브라우저 코드명|
|`navigator.platform`|플랫폼 정보|
|`navigator.appVersion`|브라우저 버젼|
|`navigator.userAgent`|사용자 정보|
|||

*사용자 정보인 (navigator.userAgent)기능을 통해 현재 사용하는 기기가 모바일인지 데스크탑인지 판별할수 있다.

## 3. geolocation

* javascript의 geolocation은 위도,경도만을 반환한다.
* 이 정보를 네이버,카카오,구글등이 제공하는 지도 서비스를 통해 시각화 하면 지도 구현이 가능하다
* navigator.geolocation.getCurrentPosition()은 2개의 파라미터와 1개의 선택사항인 옵션을 파라미터로 지정할수있다

```html
<script>
//총 3개의 파라미터를 가진 모습
navigator.geoloction.getCurrentPosition(success,error,options)
</script>
```

<br>

### 3-1. success 는 성공하여 위도와 경도를 반환해주는 역활을한다.
```html
<script>
//위도
const 변수 = position.coords.latitude;
//경도
const 변수 = position.coords.longitude;
</script>
```

<br>

### 3-2. error 는 실패시 수행될 콜백

<br>

### 3-3. options 는 선택사항으로 조회옵션으로쓰인다

```html
<script>
const options = {
    //높은 정확도 사용 하기
    enableHighAccuracy:true;
    //캐시에 저장한 위치정보를 대신 반환할 숭 있는 최대 시간을 밀리초로 나타내는 양
    //0으로 설정할 경우 캐시를 사용하지 않고 매번 gps 값을 새롭게 취득함
    maximumAge: 0
    //제한시간 제한시간 안에 조회가 성공하지 않으면 에러로 간주한다 1/1000초 단위
    timeout:100000; //10초
}
</script>
```
<br>

## 4. location

* location은 브라우저 주소표시줄을 제어하는 기능

|호출방법|기능설명|부가설명|
|---|---|---|
|`decodeURIComponent(location.href)`|문서의URL주소|디코딩으로 변환하지 않는다면 한글부분을 컴퓨터의 언어로 변환하여 주기 때문에 디코딩과정이 필요하다|
|`location.host`|호스트 이름과 포트|네이버를 예로들자면 (www.naver.com)을 도메인이라 부르지만 호스트라는 이름으로도 불리운다<br>호스트 = server가 가동중(~서비스를 제공중)인 컴퓨터<br>포트번호=해당컴퓨터에 접근하기 위한 통신경로|
|`location.hostname`|호스트 컴퓨터 이름|location.host값에서 포트번호를 제외한 순수 컴퓨터의이름 |
|`location.hash`|hash값|URL에서 (#)이후의 값|
|`decodeURIComponent(location.pathname)`|디렉토리 이하경로|전체 URL에서 host 부분을 제외한 폴더경로+파일이름|
|`location.port`|포트번호 부분|포트번호=해당컴퓨터에 접근하기 위한 통신경로|
|`location.protocol`|프로토콜 종류|프로토콜 = 통신종류 (비보안 통신(http) 보안통신(https))가 있다|
|`location.search`|URL 조회부분|?이후의 내용(hash값은 제외)<br>QueryString이라고 부른다(변수=값&변수=값....)식으로 전달됨<br>웹페이지에게 전달하는 변수들의 문자열|
||||

<br>

### 4-1. 포트번호

* 포트 번호는 컴퓨터 안에서 작동하는 애플리케이션을 식별하기 위해 사용하는 숫자이다. 포트 번호는 0~65535 까지 숫자로 범위에 따라 용도가 정해져 있다. 포트 번호는 세그먼트를 만들 때 헤더에 출발지 포트와 목적지 포트로 들어간다

* 0~1023 : 잘 알려진 포트(well-known port) 라고 해서 웹 서버나 메일 서버 등 일반적인 서버 소프트웨어가 서비스 요청을 대기할 때 사용된다.

* 1024~49151 : 등록된 포트(registered port)라고 해서 제조업체의 독자적인 서버 소프트웨어가 클라이언트 서비스 요 청을 대기할 때 사용된다.

* 49152~65535 : 동적 포트(dynamic port)로 서버가 클라이언트를 식별하기 위해 사용된다. (클라이언트에서 서버에 대해 요청을 보낼 때 출발지 포트로 랜덤으로 지정해서 보낸다.)

[더 자세히 알아보기](https://webdir.tistory.com/124)

<br>

### 4-2. hash

*(hash)란 다양한 길이를 가진 데이터 를 고정된 길이를 가진 데이터로 매핑 (mapping)한 값이다. 이를 이용해 특정한 배열의 인덱스나 위치나 위치를 입력하고자 하는 데이터의 값을 이용해 저장하거나 찾을 수 있다. 기존에 사용했던 자료 구조들은 탐색이나 삽입에 선형시간이 걸리기도 했던것에 비해, 해시를 이용하면 즉시 저장하거나 찾고자 하는 위치를 참조할 수 있으므로 더욱 빠른 속도로 처리할 수 있다. 이라고도 한다. '해쉬'가 아니라 '해시'가 올바른 표기법이다. 해시는 암호학에 있어서 매우 중요한 요소이며, 블록체인 (blockchain)을 구현하기 위한 핵심 기술이다.

[더 자세히 알아보기](http://wiki.hash.kr/index.php/%ED%95%B4%EC%8B%9C)

<br>

### 4-3. 프로토콜

*통신 프로토콜 또는 통신 규약은 컴퓨터나 원거리 통신 장비 사이에서 메시지를 주고 받는 양식과 규칙의 체계이다. 통신 프로토콜은 신호 체계, 인증, 그리고 오류 감지 및 수정 기능을 포함할 수 있다. 프로토콜은 형식, 의미론, 그리고 통신의 동기 과정 등을 정의하기는 하지만 구현되는 방법은 독립적이다. 이때문에 프로토콜은 하드웨어 또는 소프트웨어 그리고 때로는 모두를 사용하여 구현되기도 한다.

[더 자세히 알아보기](https://ko.wikipedia.org/wiki/%ED%86%B5%EC%8B%A0_%ED%94%84%EB%A1%9C%ED%86%A0%EC%BD%9C)


<br>

## 5.queryString

*  4단원인 location에서 URL 조회부분을 말한다 웹페이에 전달하는 변수들의문자열로 (변수=값&변수=값...)식으로 전달된다.
*  location.search로 문서의 url주소에서 가공된 queryString을 받을수 있으며 앞에 (?)가 붙어있다.
*  전달받은 값은 변환과정을 거쳐 html을 제어할수 있으며 queryString기능을 사용예로는 게시판의 < 1 2 3 4 5> 와같이 페이지를 이동하는걸 예로들수있다

```html
<script>
    // (?)를 제외한 데이터를 변수로 받기위한 과정
    const a = location.search.substring(1);
    
    //한줄로 이뤄져있던 다수의 (변수=값)을 잘라 배열에 넣는과정
    const b = a.split('&');
    
    //배열에 들어가있는 (변수=값)의 문자열 값을 변수와 값으로 나눠 json에 넣는 과정
    const c = {};
    b.map((v,i)=> {
        const d = v.split("=");
        //비어있던 json에게 key와 value를 주는과정
        b[d[0]] = d[1];
    })
    //json에 들어간 값을 이용해 if/switch문등을 사용하여 html을 제어한다 
```

<br>

## 6. history

* 브라우저에서의 앞으로가기 뒤로가기 버튼과 같은 기능을 구현할수 있다
* 가상의 페이지를 생성하고 백업처리를 할수있다.
* hash를 이용한 맵핑의 기술이다.
* 예시로 네이버 웹툰의 요일별 버튼을 클릭한다면 url은 동일하지만 가장뒤에 붙은 Hash값만이 변경되는걸 확인할수 있다.

|호출방법|기능설명|
|---|---|
|history.back()|이전(뒤) 페이지로 이동|
|history.forword()|앞 페이지로 이동|
|history.go()|해당 파라미터에 음수의 값을 넣으면 back()과 같은기능을사용하며 양수의 값을 넣으면 forword()와 같은 기능을 사용한다 (0)의 값을 준다면 새로고침된다.|
|history.pushState()|웹 브라우저의 페이지 이동하며 히스토리에 가상의 주소를 추가한다|
|||



## 7. 뒤로가기(이전)페이지로 이동할때 발생하는 이벤트

```html
<script>
    //웹 브라우저의 페이지 이동과 히스토리에 가상의 주소를 추가하는 기능
    history.pushState(변수,변수,변수)

    window.addEventListener('popstate',e=> {
        //history.pushState()를 처리하면서 백업해둔 정보를 돌려받는다
        console.log (e.state)

        const date = new Date();
        //Number()함수는 parseInt / parseFloat와 비슷한 기능을 가지고 있다
        //string의 데이터타입을 Number 데이터타입으로 변경해준다. 
        date.setTime(Number(e.state.time));

    })

```